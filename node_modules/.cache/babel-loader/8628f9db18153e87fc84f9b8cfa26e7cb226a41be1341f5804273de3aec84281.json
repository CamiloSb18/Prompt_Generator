{"ast":null,"code":"import React,{useState,useEffect}from'react';import{saveStory}from'../utils/storage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ResultDisplay=_ref=>{let{prompt,storyData,onStorySaved}=_ref;const[isCopied,setIsCopied]=useState(false);const[isSaved,setIsSaved]=useState(false);// Estado para el feedback de guardado\nconst[showSavedFeedback,setShowSavedFeedback]=useState(false);// Nuevo estado para la animación de guardado\n// useEffect que se ejecuta una sola vez al montar el componente,\n// o cuando prompt o storyData cambian, si no ha sido guardado\nuseEffect(()=>{// Si tienes una lógica para guardar automáticamente al renderizar,\n// asegúrate de que sea la deseada. El problema del doble guardado\n// que mencionaste puede ser debido a cómo se llama a onStorySaved o cómo\n// se maneja el estado del padre.\n// Por ahora, he ajustado la lógica para que el botón sea el principal trigger.\n// Si quieres que se guarde automáticamente al cargar si no está guardado,\n// esta lógica es correcta.\n// if (prompt && storyData && !isSaved) {\n//   handleSaveStory();\n// }\n},[prompt,storyData,isSaved]);// Agregado isSaved como dependencia si la lógica de autoguardado permanece\nconst handleCopy=()=>{navigator.clipboard.writeText(prompt);setIsCopied(true);setTimeout(()=>setIsCopied(false),2000);};const handleSaveStory=async()=>{// Hecho async para posible manejo de errores\nif(prompt&&storyData){try{await saveStory({// Usar await si saveStory es async\nprompt,name:storyData.name,// Asegúrate de que storyData.name exista\ndate:new Date().toISOString()});setIsSaved(true);// Marca como guardado para evitar re-guardado con el mismo prompt/storyData\nsetShowSavedFeedback(true);// Activa el feedback visual\nsetTimeout(()=>setShowSavedFeedback(false),2000);// Oculta el feedback después de 2 segundos\nif(onStorySaved){onStorySaved();// Notifica al componente padre si es necesario\n}}catch(error){console.error(\"Error al guardar la historia:\",error);// Puedes agregar una notificación al usuario aquí\n}}};// Si no hay prompt, no renderiza nada\nif(!prompt)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-10 bg-white rounded-lg shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 px-4 py-3 flex justify-between items-center border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-medium text-gray-800\",children:\"Prompt generado\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveStory,className:\"flex items-center space-x-1 px-3 py-1 rounded-md transition-colors \".concat(showSavedFeedback?'bg-green-100 text-green-700':'bg-green-100 text-green-700 hover:bg-green-200'),children:/*#__PURE__*/_jsx(\"span\",{children:showSavedFeedback?'¡Prompt Guardado!':'Guardar HU'})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCopy,className:\"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors\",children:/*#__PURE__*/_jsx(\"span\",{children:isCopied?'¡Copiado!':'Copiar'})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsx(\"pre\",{className:\"whitespace-pre-wrap font-mono text-sm bg-gray-50 p-4 rounded overflow-auto max-h-[300px]\",children:prompt})})]});};export default ResultDisplay;","map":{"version":3,"names":["React","useState","useEffect","saveStory","jsx","_jsx","jsxs","_jsxs","ResultDisplay","_ref","prompt","storyData","onStorySaved","isCopied","setIsCopied","isSaved","setIsSaved","showSavedFeedback","setShowSavedFeedback","handleCopy","navigator","clipboard","writeText","setTimeout","handleSaveStory","name","date","Date","toISOString","error","console","className","children","onClick","concat"],"sources":["/Users/kushki/Downloads/PromptGenerator/src/components/ResultDisplay.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { saveStory } from '../utils/storage';\n\nconst ResultDisplay = ({ prompt, storyData, onStorySaved }) => {\n  const [isCopied, setIsCopied] = useState(false);\n  const [isSaved, setIsSaved] = useState(false); // Estado para el feedback de guardado\n  const [showSavedFeedback, setShowSavedFeedback] = useState(false); // Nuevo estado para la animación de guardado\n\n  // useEffect que se ejecuta una sola vez al montar el componente,\n  // o cuando prompt o storyData cambian, si no ha sido guardado\n  useEffect(() => {\n    // Si tienes una lógica para guardar automáticamente al renderizar,\n    // asegúrate de que sea la deseada. El problema del doble guardado\n    // que mencionaste puede ser debido a cómo se llama a onStorySaved o cómo\n    // se maneja el estado del padre.\n    // Por ahora, he ajustado la lógica para que el botón sea el principal trigger.\n    // Si quieres que se guarde automáticamente al cargar si no está guardado,\n    // esta lógica es correcta.\n    // if (prompt && storyData && !isSaved) {\n    //   handleSaveStory();\n    // }\n  }, [prompt, storyData, isSaved]); // Agregado isSaved como dependencia si la lógica de autoguardado permanece\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText(prompt);\n    setIsCopied(true);\n    setTimeout(() => setIsCopied(false), 2000);\n  };\n\n  const handleSaveStory = async () => { // Hecho async para posible manejo de errores\n    if (prompt && storyData) {\n      try {\n        await saveStory({ // Usar await si saveStory es async\n          prompt,\n          name: storyData.name, // Asegúrate de que storyData.name exista\n          date: new Date().toISOString()\n        });\n        setIsSaved(true); // Marca como guardado para evitar re-guardado con el mismo prompt/storyData\n        setShowSavedFeedback(true); // Activa el feedback visual\n        setTimeout(() => setShowSavedFeedback(false), 2000); // Oculta el feedback después de 2 segundos\n\n        if (onStorySaved) {\n          onStorySaved(); // Notifica al componente padre si es necesario\n        }\n      } catch (error) {\n        console.error(\"Error al guardar la historia:\", error);\n        // Puedes agregar una notificación al usuario aquí\n      }\n    }\n  };\n\n  // Si no hay prompt, no renderiza nada\n  if (!prompt) return null;\n\n  return (\n    <div className=\"mt-10 bg-white rounded-lg shadow-sm overflow-hidden\">\n      <div className=\"bg-gray-50 px-4 py-3 flex justify-between items-center border-b border-gray-200\">\n        <h2 className=\"font-medium text-gray-800\">Prompt generado</h2>\n        <div className=\"flex space-x-2\">\n          {/* Botón Guardar HU */}\n          <button\n            onClick={handleSaveStory}\n            className={`flex items-center space-x-1 px-3 py-1 rounded-md transition-colors ${\n              showSavedFeedback ? 'bg-green-100 text-green-700' : 'bg-green-100 text-green-700 hover:bg-green-200'\n            }`}\n          >\n            {/* Texto del botón condicional */}\n            <span>{showSavedFeedback ? '¡Prompt Guardado!' : 'Guardar HU'}</span>\n          </button>\n          \n          {/* Botón Copiar */}\n          <button\n            onClick={handleCopy}\n            className=\"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors\"\n          >\n            <span>{isCopied ? '¡Copiado!' : 'Copiar'}</span>\n          </button>\n        </div>\n      </div>\n      <div className=\"p-4\">\n        <pre className=\"whitespace-pre-wrap font-mono text-sm bg-gray-50 p-4 rounded overflow-auto max-h-[300px]\">\n          {prompt}\n        </pre>\n      </div>\n    </div>\n  );\n};\n\nexport default ResultDisplay;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}